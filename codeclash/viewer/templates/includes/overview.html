<!-- Overview Section -->
<section class="overview-section">
    <h2><i class="bi bi-bar-chart"></i> Overview</h2>

    <div class="overview-summary">
        <table class="table table-striped table-hover results-table">
            <thead>
                <tr>
                    <th>Round</th>
                    <th>Winner</th>
                    <th>Results</th>
                    {% for trajectory in trajectories_by_round.get(1, []) %}
                        <th>{{ trajectory.player_id }}</th>
                    {% endfor %}
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for round_data in metadata.rounds %}
                    <tr>
                        <td>{{ round_data.round_num }}</td>
                        <td>
                            {% if round_data.results and round_data.results.winner %}
                                <div class="winner-breakdown">
                                    <span class="winner-badge">{{ round_data.results.winner }}</span>
                                    {% if round_data.results.winner_percentage %}
                                        <span class="score-item">{{ round_data.results.winner_percentage }}%</span>
                                    {% endif %}
                                    {% if round_data.results.p_value is not none %}
                                        <span class="score-item">p={{ "%.2f"|format(round_data.results.p_value) }}</span>
                                    {% endif %}
                                </div>
                            {% else %}
                                <span class="no-result">-</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if round_data.results and round_data.results.sorted_scores %}
                                <div class="score-breakdown">
                                    {% for player, score in round_data.results.sorted_scores %}
                                        <span class="score-item">{{ player }}: {{ score }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <span class="no-result">-</span>
                            {% endif %}
                        </td>
                        {% if trajectories_by_round.get(round_data.round_num) %}
                            {% for trajectory in trajectories_by_round[round_data.round_num] %}
                                <td>
                                    <div class="overview-cell-content">
                                        <span class="steps-price">{{ trajectory.api_calls }}/${{ "%.2f"|format(trajectory.cost) }}</span>
                                        {% if trajectory.exit_status %}
                                            <span class="exit-status-small status-{{ trajectory.exit_status.lower() }}">{{ trajectory.exit_status }}</span>
                                        {% else %}
                                            <span class="no-result">-</span>
                                        {% endif %}
                                    </div>
                                </td>
                            {% endfor %}
                        {% else %}
                            {% for trajectory in trajectories_by_round.get(1, []) %}
                                <td><span class="no-result">-</span></td>
                            {% endfor %}
                        {% endif %}
                        <td>
                            <button class="btn btn-primary btn-sm nav-to-round-btn" data-round="{{ round_data.round_num }}" title="Jump to Round {{ round_data.round_num }} details">
                                <i class="bi bi-arrow-down"></i>
                            </button>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Tournament Log -->
    <details class="foldout">
        <summary>
            <i class="bi bi-journal"></i> Tournament Log
            {% if metadata.main_log_path %}
            <button class="copy-path-btn-small" data-path="{{ metadata.main_log_path }}" title="Copy file path">
                <i class="bi bi-clipboard"></i> Copy path
            </button>
            {% endif %}
        </summary>
        <div class="log-content-container">
            <pre class="log-content-scrollable"><code>{{ metadata.main_log }}</code></pre>
        </div>
    </details>

    <!-- All Other Logs -->
    {% if metadata.all_logs %}
        {% for log_name, log_data in metadata.all_logs.items() %}
            {% if log_name != "Tournament Log" %}
            <details class="foldout">
                <summary>
                    <i class="bi bi-journal"></i> {{ log_name }}
                    {% if log_data.path %}
                    <button class="copy-path-btn-small" data-path="{{ log_data.path }}" title="Copy file path">
                        <i class="bi bi-clipboard"></i> Copy path
                    </button>
                    {% endif %}
                </summary>
                <div class="log-content-container">
                    <pre class="log-content-scrollable"><code>{{ log_data.content }}</code></pre>
                </div>
            </details>
            {% endif %}
        {% endfor %}
    {% endif %}
</section>
